<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-vDwlAsEa.css">
</head>
<body>
    <div id="app">
        <header class="header">
            <h1>
                üéÆ PUBG Store
                <div id="header-loading" class="header-loading"></div>
            </h1>
            <button id="admin-btn" class="admin-btn" title="–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å" onclick="handleAdminClick()">
                <span class="admin-btn-icon">‚öôÔ∏è</span>
                <span class="admin-badge" id="admin-badge"></span>
            </button>
        </header>
        
        <main class="main">
            <div id="products-container" class="products-container">
                <div class="empty-state">
                    <h2>üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω –ø—É—Å—Ç</h2>
                    <p>–¢–æ–≤–∞—Ä—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º</p>
                </div>
            </div>
        </main>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∞ -->
        <div id="admin-auth-modal" class="modal admin-auth-modal">
            <div class="modal-content auth-modal-content">
                <button class="close auth-close" onclick="closeAdminAuth()">√ó</button>
                
                <div class="auth-header">
                    <div class="auth-icon">üîê</div>
                    <h2>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
                    <p class="auth-subtitle">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</p>
                </div>
                
                <div class="auth-body">
                    <div class="input-group">
                        <input 
                            type="password" 
                            id="admin-password" 
                            placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
                            class="password-input"
                            onkeypress="handleAuthKeypress(event)"
                        >
                        <div class="password-toggle" id="password-toggle" onclick="togglePasswordVisibility()">
                            üëÅÔ∏è
                        </div>
                    </div>
                    <div class="password-strength"></div>
                    
                    <button id="auth-submit" class="btn auth-submit-btn" onclick="handleAdminAuth()">
                        <span class="btn-text">–í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</span>
                        <span class="btn-loading" style="display: none;">
                            <div class="loading"></div>
                            –ü—Ä–æ–≤–µ—Ä–∫–∞...
                        </span>
                    </button>
                </div>
                
                <div class="auth-footer">
                    <p class="auth-hint">
        üí° –ï—Å–ª–∏ –≤—ã –∑–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –≥–ª–∞–≤–Ω–æ–º—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
                    </p>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
        <div id="add-product-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal(this.parentElement.parentElement)">√ó</span>
                <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h2>
                <form id="product-form">
                    <div class="input-group">
                        <input type="text" id="product-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" required>
                    </div>
                    <div class="input-group">
                        <input type="number" id="product-price" placeholder="–¶–µ–Ω–∞ –≤ —Ä—É–±–ª—è—Ö" step="0.01" required>
                    </div>
                    <div class="input-group">
                        <textarea id="product-description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" rows="3"></textarea>
                    </div>
                    <div class="input-group">
                        <input type="url" id="product-buy-link" placeholder="–°—Å—ã–ª–∫–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ (https://t.me/KOZLIK_pubg_shop_bot?start=c_123456)">
                    </div>
                    <div class="input-group">
                        <label for="product-image" class="file-label">
                            üì∏ –í—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
                        </label>
                        <input type="file" id="product-image" accept="image/*" class="file-input">
                    </div>
                    <div class="image-preview" id="image-preview"></div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <span class="btn-text">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</span>
                            <span class="btn-loading" style="display: none;">
                                <div class="loading"></div>
                                –î–æ–±–∞–≤–ª–µ–Ω–∏–µ...
                            </span>
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal(this.closest('.modal'))">
                            ‚ùå –û—Ç–º–µ–Ω–∞
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è -->
        <div id="change-password-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal(this.parentElement.parentElement)">√ó</span>
                <h2>üîê –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</h2>
                <div class="modal-hint">
                    üí° –ü–∞—Ä–æ–ª—å –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                </div>
                <form id="change-password-form">
                    <div class="input-group">
                        <input type="password" id="current-password" placeholder="–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å" required>
                    </div>
                    <div class="input-group">
                        <input type="password" id="new-password" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" required>
                    </div>
                    <div class="input-group">
                        <input type="password" id="confirm-password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            üîÑ –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal(this.closest('.modal'))">
                            ‚ùå –û—Ç–º–µ–Ω–∞
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ GitHub —Ç–æ–∫–µ–Ω–∞ -->
        <div id="github-token-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal(this.parentElement.parentElement)">√ó</span>
                <h2>üîó GitHub —Ç–æ–∫–µ–Ω</h2>
                <form id="github-token-form">
                    <div class="input-group">
                        <input type="password" id="github-token-input" placeholder="–í–≤–µ–¥–∏—Ç–µ GitHub Personal Access Token" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal(this.closest('.modal'))">
                            ‚ùå –û—Ç–º–µ–Ω–∞
                        </button>
                    </div>
                </form>
                <div class="token-status">
                    <span id="token-status">‚ùå –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</span>
                </div>
                <div class="modal-hint">
                    üîê –¢–æ–∫–µ–Ω –Ω—É–∂–µ–Ω –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
                </div>
            </div>
        </div>

        <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
        <div id="admin-panel" class="admin-panel">
            <button id="add-product-btn" class="btn btn-primary" onclick="openAddProductModal()">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
            </button>
            <button id="logout-btn" class="btn btn-secondary" onclick="handleAdminLogout()">
                üëã –í—ã–π—Ç–∏
            </button>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
        <div id="refresh-panel" class="refresh-panel">
            <button id="refresh-products-btn" class="btn btn-secondary" onclick="handleRefreshProducts()">
                üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä—ã
            </button>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω–∞ -->
        <div id="admin-context-menu" class="admin-context-menu hidden">
            <button id="change-password-btn" class="context-menu-item" onclick="openChangePasswordModal()">
                <span class="menu-icon">üîê</span>
                <span class="menu-text">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</span>
            </button>
            <button id="github-token-btn" class="context-menu-item" onclick="openGithubTokenModal()">
                <span class="menu-icon">üîó</span>
                <span class="menu-text">GitHub —Ç–æ–∫–µ–Ω</span>
            </button>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–æ–≤–∞—Ä–∞ -->
        <div id="product-detail-modal" class="modal">
            <div class="modal-content product-detail-content">
                <span class="close" onclick="closeProductDetail()">√ó</span>
                <div id="product-detail-body">
                    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>
    
    <!-- Fullscreen Image Overlay -->
    <div id="fullscreen-overlay" class="fullscreen-overlay">
        <img id="fullscreen-image" class="fullscreen-image" src="" alt="">
        <button id="fullscreen-close" class="fullscreen-close" onclick="closeFullscreen()">‚úï</button>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram.WebApp;
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        tg.ready();
        tg.expand();

        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
        let ADMIN_PASSWORD = localStorage.getItem('admin_password') || 'admin123';
        const GITHUB_OWNER = 'Xellouey';
        const GITHUB_REPO = 'PubgTGApp';
        const GITHUB_FILE = 'products.json';
        const GITHUB_API_URL = `https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/${GITHUB_FILE}`;
        
        let GITHUB_TOKEN = localStorage.getItem('github_token') || null;
        let githubSha = null;
        let isAdmin = false;
        let products = [];

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        let productsContainer, adminBtn, adminAuthModal, addProductModal, adminPanel;
        let adminPassword, authSubmit, addProductBtn, logoutBtn, productForm;
        let imagePreview, productImage;

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        window.handleAdminClick = function() {
            const adminContextMenu = document.getElementById('admin-context-menu');
            
            if (isAdmin) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –∞–¥–º–∏–Ω–∞
                if (adminContextMenu) {
                    adminContextMenu.classList.toggle('hidden');
                }
            } else {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                openAdminAuthModal();
            }
        }

        window.openAdminAuthModal = function() {
            const modal = document.getElementById('admin-auth-modal');
            if (modal) {
                modal.style.display = 'flex';
                // –§–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è
                setTimeout(() => {
                    const passwordInput = document.getElementById('admin-password');
                    if (passwordInput) {
                        passwordInput.focus();
                    }
                }, 300);
            }
        }

        window.closeAdminAuth = function() {
            const modal = document.getElementById('admin-auth-modal');
            if (modal) {
                modal.style.display = 'none';
                const passwordInput = document.getElementById('admin-password');
                if (passwordInput) {
                    passwordInput.value = '';
                    passwordInput.classList.remove('error', 'success');
                }
            }
        }

        window.handleAuthKeypress = function(event) {
            if (event.key === 'Enter') {
                handleAdminAuth();
            }
        }

        window.togglePasswordVisibility = function() {
            const passwordInput = document.getElementById('admin-password');
            const toggle = document.getElementById('password-toggle');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggle.textContent = 'üôà';
            } else {
                passwordInput.type = 'password';
                toggle.textContent = 'üëÅÔ∏è';
            }
        }

        window.handleAdminAuth = function() {
            const passwordInput = document.getElementById('admin-password');
            const submitBtn = document.getElementById('auth-submit');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnLoading = submitBtn.querySelector('.btn-loading');
            const password = passwordInput.value;

            if (!password) {
                passwordInput.classList.add('error');
                showToast('‚ùå –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å', 'error');
                return;
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            btnText.style.display = 'none';
            btnLoading.style.display = 'flex';
            submitBtn.disabled = true;

            setTimeout(() => {
                if (password === ADMIN_PASSWORD) {
                    // –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
                    passwordInput.classList.add('success');
                    passwordInput.classList.remove('error');
                    
                    isAdmin = true;
                    updateAdminUI();
                    
                    setTimeout(() => {
                        closeAdminAuth();
                        showToast('üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å!', 'success');
                        
                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                        btnText.style.display = 'block';
                        btnLoading.style.display = 'none';
                        submitBtn.disabled = false;
                    }, 1000);
                    
                } else {
                    // –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                    passwordInput.classList.add('error');
                    passwordInput.classList.remove('success');
                    passwordInput.style.animation = 'shake 0.5s ease-in-out';
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                    btnText.style.display = 'block';
                    btnLoading.style.display = 'none';
                    submitBtn.disabled = false;
                    
                    setTimeout(() => {
                        passwordInput.style.animation = '';
                    }, 500);
                    
                    showToast('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!', 'error');
                }
            }, 1000);
        }

        function updateAdminUI() {
            const adminBtn = document.getElementById('admin-btn');
            const adminPanel = document.getElementById('admin-panel');
            const adminBadge = document.getElementById('admin-badge');
            
            if (adminBtn) {
                adminBtn.style.opacity = '1';
                adminBtn.style.transform = 'scale(1.1)';
            }
            
            if (adminPanel) {
                adminPanel.style.display = 'flex';
            }
            
            if (adminBadge) {
                adminBadge.textContent = 'ADMIN';
            }
            
            renderProducts();
        }

        window.handleAdminLogout = function() {
            isAdmin = false;
            const adminBtn = document.getElementById('admin-btn');
            const adminPanel = document.getElementById('admin-panel');
            const adminBadge = document.getElementById('admin-badge');
            const adminContextMenu = document.getElementById('admin-context-menu');
            
            if (adminBtn) {
                adminBtn.style.opacity = '0.3';
                adminBtn.style.transform = 'scale(1)';
            }
            
            if (adminPanel) {
                adminPanel.style.display = 'none';
            }
            
            if (adminBadge) {
                adminBadge.textContent = '';
            }
            
            if (adminContextMenu) {
                adminContextMenu.classList.add('hidden');
            }
            
            renderProducts();
            showToast('üëã –í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏', 'info');
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        window.openAddProductModal = function() {
            const modal = document.getElementById('add-product-modal');
            if (modal) {
                modal.style.display = 'block';
            }
        }

        window.openChangePasswordModal = function() {
            const modal = document.getElementById('change-password-modal');
            if (modal) {
                modal.style.display = 'block';
                document.getElementById('admin-context-menu').classList.add('hidden');
            }
        }

        window.openGithubTokenModal = function() {
            const modal = document.getElementById('github-token-modal');
            if (modal) {
                modal.style.display = 'block';
                document.getElementById('admin-context-menu').classList.add('hidden');
            }
        }

        window.handleRefreshProducts = function() {
            loadProducts();
            showToast('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä—ã...', 'info');
        }

        // –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        window.closeModal = function(modal) {
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (loadProducts, renderProducts, saveProducts, –∏ —Ç.–¥.)
        // –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ –≤–∞—à–µ–≥–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞...

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ DOM
            productsContainer = document.getElementById('products-container');
            adminBtn = document.getElementById('admin-btn');
            adminAuthModal = document.getElementById('admin-auth-modal');
            addProductModal = document.getElementById('add-product-modal');
            adminPanel = document.getElementById('admin-panel');
            adminPassword = document.getElementById('admin-password');
            authSubmit = document.getElementById('auth-submit');
            addProductBtn = document.getElementById('add-product-btn');
            logoutBtn = document.getElementById('logout-btn');
            productForm = document.getElementById('product-form');
            imagePreview = document.getElementById('image-preview');
            productImage = document.getElementById('product-image');

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
            loadProducts();

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
            document.addEventListener('click', function(e) {
                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                if (e.target === adminAuthModal) {
                    closeAdminAuth();
                }
                
                // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥—Ä—É–≥–∏—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
                document.querySelectorAll('.modal').forEach(modal => {
                    if (e.target === modal && modal.id !== 'admin-auth-modal') {
                        closeModal(modal);
                    }
                });

                // –ó–∞–∫—Ä—ã—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é –∞–¥–º–∏–Ω–∞
                const adminContextMenu = document.getElementById('admin-context-menu');
                if (adminContextMenu && !adminContextMenu.classList.contains('hidden') &&
                    !e.target.closest('#admin-context-menu') && 
                    !e.target.closest('#admin-btn')) {
                    adminContextMenu.classList.add('hidden');
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const adminAuthModal = document.getElementById('admin-auth-modal');
                    if (adminAuthModal.style.display === 'flex') {
                        closeAdminAuth();
                    }
                    
                    document.querySelectorAll('.modal').forEach(modal => {
                        if (modal.style.display === 'block') {
                            closeModal(modal);
                        }
                    });
                    
                    const adminContextMenu = document.getElementById('admin-context-menu');
                    if (adminContextMenu && !adminContextMenu.classList.contains('hidden')) {
                        adminContextMenu.classList.add('hidden');
                    }
                }
            });
        });

        // –û—Å—Ç–∞–ª—å–Ω–æ–π –≤–∞—à JavaScript –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –∑–¥–µ—Å—å...
        // (—Ñ—É–Ω–∫—Ü–∏–∏ loadProducts, renderProducts, saveProducts, buyProduct, –∏ —Ç.–¥.)
    </script>
</body>
</html>
